import"./chunk-GGQ7LRWG.js";import{$ as h,B as Y,Ca as N,Da as v,E as W,Fa as u,G as Z,Ga as x,H as a,Ia as b,K as y,L as l,Ma as nt,P as M,Qa as j,T as m,V as k,W as _,X as g,Y as f,Z as r,_ as o,aa as Q,ba as d,ca as C,da as c,ea as D,fa as I,ga as tt,la as J,p as X,sa as A,va as et,w as P,x as S,y as q}from"./chunk-LD66H5SA.js";var rt=i=>({"border border-3 border-success":i}),ot=i=>[i];function at(i,e){return this.quantity}function st(i,e){if(i&1){let t=Q();r(0,"button",5),d("click",function(){S(t);let s=C();return q(s.toggleHyphen())}),c(1,"ADD"),o()}}function ct(i,e){if(i&1&&(r(0,"div",6),c(1),o()),i&2){let t=e.$implicit,n=C(2);m("@countChange",n.quantity),a(),I(" ",t," ")}}function mt(i,e){if(i&1&&(r(0,"div",3),g(1,ct,2,2,"div",6,at,!0),o()),i&2){let t=C();a(),f(J(0,ot,t.quantity))}}var H=class i{quantity=0;showHyphen=!1;showSymbols=!1;quantityChanged=new Y;ngOnChanges(e){e.quantity&&this.quantity===0&&(this.showHyphen=!1)}toggleHyphen(){this.showHyphen=!this.showHyphen,this.increment()}toggleSymbols(){this.showSymbols=!this.showSymbols}increment(){this.quantity++,this.quantityChanged.emit({productId:0,quantity:this.quantity})}decrement(){this.quantity>0&&this.quantity--,this.quantity===0&&(this.showHyphen=!1),this.quantityChanged.emit({productId:0,quantity:this.quantity})}clearQty(){this.quantity=0,this.showHyphen=!1,this.quantityChanged.emit({productId:0,quantity:this.quantity})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["add-button"]],inputs:{quantity:"quantity"},outputs:{quantityChanged:"quantityChanged"},features:[P],decls:7,vars:8,consts:[[1,"d-flex","bg-white","rounded","shadow","text-center","justify-content-between","py-1",2,"width","130px",3,"ngClass"],[1,"btn","col-xl-3",3,"click","longPress"],[1,"btn","col-xl"],[1,"position-relative","d-flex",2,"align-items","center","justify-content","center"],[1,"btn","col-xl-3",3,"click"],[1,"btn","col-xl",3,"click"],[1,"count-number"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"button",1),d("click",function(){return n.decrement()})("longPress",function(){return n.clearQty()}),c(2,"-"),o(),M(3,st,2,0,"button",2)(4,mt,3,2,"div",3),r(5,"button",4),d("click",function(){return n.increment()}),c(6,"+"),o()()),t&2&&(m("ngClass",J(6,rt,n.quantity>0)),a(),m("@slideInLeft",void 0)("@slideInLeft",n.showHyphen?"visible":"hidden"),a(2),k(n.quantity<=0?3:4),a(2),m("@slideInRight",void 0)("@slideInRight",n.showHyphen?"visible":"hidden"))},dependencies:[et],encapsulation:2,data:{animation:[N("slideInLeft",[x("hidden",u({transform:"translateX(-100%)",opacity:0})),x("visible",u({transform:"translateX(0)",opacity:1})),b("hidden => visible",v("300ms ease-out")),b("visible => hidden",v("200ms ease-in"))]),N("slideInRight",[x("hidden",u({transform:"translateX(100%)",opacity:0})),x("visible",u({transform:"translateX(0)",opacity:1})),b("hidden => visible",v("300ms ease-out")),b("visible => hidden",v("200ms ease-in"))]),N("countChange",[b(":increment",[u({transform:"translateY(100%)",opacity:0}),v("250ms ease-out",u({transform:"translateY(0)",opacity:1}))]),b(":decrement",[u({transform:"translateY(-100%)",opacity:0}),v("250ms ease-out",u({transform:"translateY(0)",opacity:1}))])])]}})};var T=class{Id=0;Name="";BasePrice=0;UPPrice=0;ImgUrl;ProductCode;ProductTypeId=0;BarCode;IsActive=!1;IsOnline=!1;IsRecomended=!1;CreatedDate=new Date;ModifiedDate=new Date;CGSTPercentage=0;SGSTPercentage=0;IGSTPercentage=0;_FoodPrepTime=0;CategoryId=0;Category;StoreId;KOTGroupId;TaxGroupId=0;PreparationTime="";Quantity=0;constructor(e){Object.assign(this,e)}},B=class{Id=0;ParentCategoryId;Name="";Products=[];Childcategories=[];constructor(e){Object.assign(this,e)}},O=class{parent_categories=[];categories=[];products=[];constructor(e){Object.assign(this,e)}};var V=class{product=new T;quantity=0},$=class{CartItems=[];TableId="";CustomerName="";CustomerPhoneNumber="";OrderedDate=new Date;OrderStatus=0;KOTNumber=""};var w=class i{quantityEvt=W(null);constructor(){}emitQuantityChange(e){this.quantityEvt.set(e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=X({token:i,factory:i.\u0275fac,providedIn:"root"})};var z=class i{constructor(e){this.menuservice=e;A(()=>{let t=this.menuservice.quantityEvt();t&&t.productId===this.product.Id?this.quantity=t.quantity:t&&t.productId===0&&t.quantity===0&&(this.quantity=0)})}product=new T;quantity=0;handleQuantityChange(e){e.productId=this.product.Id,this.menuservice.emitQuantityChange(e)}static \u0275fac=function(t){return new(t||i)(y(w))};static \u0275cmp=l({type:i,selectors:[["menu-item"]],inputs:{product:"product"},decls:11,vars:4,consts:[[1,"container","mb-5"],[1,"d-flex","justify-content-between"],[1,"col-xl-6"],[1,"font-size-7"],[1,"position-relative"],["loading","lazy","height","144","width","156","alt","Kadai Paneer",1,"rounded-4","object-fit-cover",3,"src"],[1,"bottom-center-overlay",3,"quantityChanged","quantity"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),c(4),o(),r(5,"h5"),c(6),o()(),r(7,"div",2)(8,"div",4),h(9,"img",5),r(10,"add-button",6),d("quantityChanged",function(p){return n.handleQuantityChange(p)}),o()()()()()),t&2&&(a(4),D(n.product.Name),a(2),I("\u20B9",n.product.BasePrice,""),a(3),m("src",n.product.ImgUrl,Z),a(),m("quantity",n.quantity))},dependencies:[H],styles:[".container-multi-line[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.bottom-center-overlay[_ngcontent-%COMP%]{width:auto;position:absolute;left:50%;bottom:0;transform:translate3d(-50%,50%,10px)}"]})};var dt=(i,e)=>e.Id;function ut(i,e){if(i&1&&h(0,"menu-item",1),i&2){let t=e.$implicit;m("product",t)}}function pt(i,e){if(i&1&&g(0,ut,1,1,"menu-item",1,dt),i&2){let t=e.$implicit;f(t.Products)}}function gt(i,e){if(i&1&&g(0,pt,2,0,null,null,_),i&2){let t=e.$implicit;f(t.Childcategories)}}var L=class i{constructor(e){this.auth=e}catalogue=new O;cartItems=[];categories=[];ngOnChanges(e){e.catalogue&&this.getCatatLogue(),e.cartItems&&console.log("Cart Items changed:")}getCatatLogue(){this.catalogue.parent_categories.forEach(t=>{var t=new B(t),n=this.catalogue.categories.filter(s=>s.ParentCategoryId===t.Id).map(s=>new B(s));n.forEach(s=>{s.Products=this.catalogue.products.filter(p=>p.CategoryId===s.Id).map(p=>new T(p))}),t.Childcategories=n,this.categories.push(new B(t))})}setQuantity(){}static \u0275fac=function(t){return new(t||i)(y(j))};static \u0275cmp=l({type:i,selectors:[["app-menu"]],inputs:{catalogue:"catalogue",cartItems:"cartItems"},features:[P],decls:3,vars:0,consts:[[1,"mt-4"],[3,"product"]],template:function(t,n){t&1&&(r(0,"div",0),g(1,gt,2,0,null,null,_),o()),t&2&&(a(),f(n.categories))},dependencies:[z],encapsulation:2})};function ft(i,e){if(i&1){let t=Q();r(0,"div",9),d("click",function(){S(t);let s=C();return q(s.isExpanded=!1)}),o()}}function ht(i,e){if(i&1){let t=Q();r(0,"tr",7)(1,"td"),c(2),o(),r(3,"td")(4,"button",10),d("click",function(){let s=S(t).$implicit,p=C();return q(p.decrease(s.product.Id))}),c(5,"-"),o()(),r(6,"td"),c(7),o(),r(8,"td")(9,"button",11),d("click",function(){let s=S(t).$implicit,p=C();return q(p.increase(s.product.Id))}),c(10,"+"),o()(),r(11,"td"),c(12),o(),r(13,"td")(14,"button",10),d("click",function(){let s=S(t).$implicit,p=C();return q(p.removeItem(s.product.Id))}),c(15,"\xD7"),o()()()}if(i&2){let t=e.$implicit;a(2),D(t.product.Name),a(5),I(" x ",t.quantity,""),a(5),I("\u20B9",t.product.BasePrice*t.quantity,"")}}var R=class i{constructor(e){this.menuservice=e}cartItems=[];itemCount=0;totalPrice=0;isExpanded=!1;ngOnChanges(e){e.cartItems&&(this.itemCount=this.cartItems.reduce((t,n)=>t+n.quantity,0),this.totalPrice=this.cartItems.reduce((t,n)=>t+n.product.BasePrice*n.quantity,0),this.itemCount<=0&&(this.isExpanded=!1))}decrease(e){var t=this.cartItems.find(n=>n.product.Id===e);t&&t.quantity>0&&(t.quantity--,this.menuservice.emitQuantityChange({productId:e,quantity:t.quantity}))}increase(e){var t=this.cartItems.find(n=>n.product.Id===e);t&&(t.quantity++,this.menuservice.emitQuantityChange({productId:e,quantity:t.quantity}))}removeItem(e){var t=this.cartItems.find(n=>n.product.Id===e);console.log("removeItem called",e,t),t&&(console.log("removing item",e),this.menuservice.emitQuantityChange({productId:e,quantity:0}))}placeOrder(){let e=localStorage.getItem("orders.pending")?JSON.parse(localStorage.getItem("orders.pending")||"[]"):[],t=localStorage.getItem("kotno")?parseInt(localStorage.getItem("kotno")||"1"):1,n=new $;n.CartItems=this.cartItems,n.TableId="";let s=localStorage.getItem("login.customer")?JSON.parse(localStorage.getItem("login.customer")||"{}"):{name:"",phonenumber:""};n.CustomerName=s.name,n.CustomerPhoneNumber=s.phonenumber,n.OrderedDate=new Date,n.OrderStatus=0,n.KOTNumber=t.toString().padStart(4,"0"),e.push(n),localStorage.setItem("orders.pending",JSON.stringify(e)),localStorage.setItem("kotno",(t+1).toString()),console.log("Cart Items",this.cartItems),this.clearCart()}clearCart(){this.menuservice.emitQuantityChange({productId:0,quantity:0})}static \u0275fac=function(t){return new(t||i)(y(w))};static \u0275cmp=l({type:i,selectors:[["mini-cart"]],inputs:{cartItems:"cartItems"},features:[P],decls:17,vars:6,consts:[[1,"backdrop","z-2"],[1,"position-fixed","bottom-0","w-100","z-3"],[1,"bg-success","text-white","py-2","px-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","text-white","d-flex","gap-1",3,"click"],["src","/assets/svgs/cart.svg","height","20","alt","","srcset",""],[1,"table","table-success"],[2,"vertical-align","middle"],[1,"btn","btn-outline-light","w-100",3,"click"],[1,"backdrop","z-2",3,"click"],[1,"btn","text-danger","p-0","w-100","font-size-9",3,"click"],[1,"btn","text-success","p-0","w-100","font-size-9",3,"click"]],template:function(t,n){t&1&&(M(0,ft,1,0,"div",0),r(1,"div",1)(2,"div",2)(3,"div",3)(4,"span"),c(5),o(),r(6,"button",4),d("click",function(){return n.isExpanded=!n.isExpanded}),r(7,"span"),c(8,"VIEW CART"),o(),h(9,"img",5),o()(),r(10,"div")(11,"table",6)(12,"tbody"),g(13,ht,16,3,"tr",7,_),o()(),r(15,"button",8),d("click",function(){return n.placeOrder()}),c(16,"Place Order"),o()()()()),t&2&&(k(n.isExpanded?0:-1),a(),m("@expandCollapse",n.itemCount>0?"expanded":"collapsed"),a(4),tt(" ",n.itemCount," Item",n.itemCount>1?"s":""," added | Total: \u20B9",n.totalPrice," "),a(5),m("@expandCollapse",n.isExpanded?"expanded":"collapsed"),a(3),f(n.cartItems))},styles:[".backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#00000080;transition:opacity .3s ease}"],data:{animation:[N("expandCollapse",[x("collapsed",u({height:"0",overflow:"hidden",opacity:1})),x("expanded",u({height:"*",overflow:"hidden",opacity:1})),b("collapsed <=> expanded",[v("300ms ease")])])]}})};var G=class i{customername="";static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["app-header"]],inputs:{customername:"customername"},decls:6,vars:1,consts:[[1,"bg-danger","px-3","py-3","sticky-top","text-white","font-size-7"],[1,"text-capitalize"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"span"),c(2,"Welcome "),r(3,"span",1),c(4),o(),c(5,"!"),o()()),t&2&&(a(4),D(n.customername))},encapsulation:2})};function Ct(i,e){}function yt(i,e){if(i&1&&(r(0,"div",0)(1,"div",1)(2,"h5",2),c(3),o(),r(4,"span"),c(5),o()(),r(6,"div",3),g(7,Ct,0,0,null,null,_),o()()),i&2){let t=e.$implicit;a(3),I("#",t.KOTNumber,""),a(2),I("",t.CartItems.length," Items"),a(2),f(t.CartItems)}}var K=class i{ordersPending=[];constructor(){let e=localStorage.getItem("orders.pending");e&&(this.ordersPending=JSON.parse(e)),console.log("Pending Orders:",this.ordersPending)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["app-orderhistory"]],decls:2,vars:0,consts:[[1,"border","border-warning","my-2","mx-2","shadow-sm"],[1,"d-flex","justify-content-between","align-items-center","p-3","mb-3","border-bottom"],[1,"m-0"],[1,"d-flex"]],template:function(t,n){t&1&&g(0,yt,9,2,"div",0,_),t&2&&f(n.ordersPending)},encapsulation:2})};function It(i,e){i&1&&h(0,"app-orderhistory")}function vt(i,e){if(i&1&&(r(0,"div",1),h(1,"app-menu",2),o(),h(2,"mini-cart",3)),i&2){let t=C();a(),m("catalogue",t.catalogue)("cartItems",t.cartItems),a(),m("cartItems",t.cartItems)}}var it=class i{constructor(e,t,n){this.route=e;this.auth=t;this.menuservice=n;this.loginedInCustomer=this.auth.getLoggedInCustomer(),A(()=>{let s=this.menuservice.quantityEvt();s&&this.handleQuantityChange(s)})}tableId=null;cartItems=[];catalogue=new O;loginedInCustomer=null;mode="orderhistory";ngOnInit(){this.tableId=this.route.snapshot.paramMap.get("tableId"),this.getCatatLogue()}getCatatLogue(){this.auth.getMenu().subscribe(e=>{this.catalogue=new O(e)},e=>{alert("Error fetching menu data: "+e.message)})}handleQuantityChange(e){if(e.productId===0&&e.quantity===0){console.log("Clearing cart items"),this.cartItems=[];return}if(e.quantity<=0&&this.cartItems.findIndex(t=>t.product.Id===e.productId)!==-1)this.cartItems=this.cartItems.filter(t=>t.product.Id!==e.productId);else{let t=this.cartItems.findIndex(n=>n.product.Id===e.productId);if(t!==-1)this.cartItems[t].quantity=e.quantity;else{let n=new V;n.product=this.catalogue.products.find(s=>s.Id===e.productId)||n.product,n.quantity=e.quantity,this.cartItems.push(n)}}this.cartItems=[...this.cartItems]}static \u0275fac=function(t){return new(t||i)(y(nt),y(j),y(w))};static \u0275cmp=l({type:i,selectors:[["app-table"]],decls:3,vars:2,consts:[[3,"customername"],[1,"container"],[3,"catalogue","cartItems"],[3,"cartItems"]],template:function(t,n){t&1&&(h(0,"app-header",0),M(1,It,1,0,"app-orderhistory")(2,vt,3,3)),t&2&&(m("customername",n.loginedInCustomer?n.loginedInCustomer.name:"-"),a(),k(n.mode==="orderhistory"?1:2))},dependencies:[L,R,G,K],encapsulation:2})};export{it as TableComponent};
